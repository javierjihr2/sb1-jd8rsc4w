"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2673],{30411:(e,r,a)=>{a.d(r,{S:()=>l});var o=a(12115),i=a(21863),n=a(65927),t=a(6267);let c=async(e,r)=>{try{let a=await fetch("https://nominatim.openstreetmap.org/reverse?format=json&lat=".concat(e,"&lon=").concat(r,"&zoom=10&addressdetails=1"),{headers:{"User-Agent":"SquadGO-Battle-App/1.0"}});if(!a.ok)throw Error("Error en la respuesta de geocodificaci\xf3n");let o=await a.json();if(!o||!o.address)return null;let i=o.address,n=i.city||i.town||i.village||i.municipality||i.county||"Ciudad no disponible",t=i.state||i.province||i.region||"Estado no disponible",c=i.country||"Pa\xeds no disponible",l=o.display_name||"Direcci\xf3n no disponible";return{city:n,state:t,country:c,fullAddress:l}}catch(e){return console.error("Error obteniendo informaci\xf3n de ubicaci\xf3n:",e),null}},l=()=>{let[e,r]=(0,o.useState)({location:!1,camera:!1,microphone:!1,isLoading:!0,error:null,hasAskedBefore:{location:!1,camera:!1,microphone:!1},deniedPermanently:{location:!1,camera:!1,microphone:!1}}),[a,l]=(0,o.useState)(null),[s,d]=(0,o.useState)(null),u=(0,o.useCallback)(async()=>{try{r(e=>({...e,isLoading:!0,error:null}));let[e,a,o]=await Promise.all([m(),g(),f()]);r(r=>({...r,location:e,camera:a,microphone:o,isLoading:!1,error:null}))}catch(e){r(e=>({...e,isLoading:!1,error:"Error al verificar permisos"}))}},[]);(0,o.useEffect)(()=>{u()},[]);let m=async()=>{try{if(!t.Ii.isNativePlatform()){if(!("geolocation"in navigator))return console.log("\uD83D\uDEAB Geolocalizaci\xf3n no disponible en este navegador"),!1;if("permissions"in navigator)try{let e=await navigator.permissions.query({name:"geolocation"});return console.log("\uD83D\uDD0D Estado del permiso de geolocalizaci\xf3n:",e.state),"granted"===e.state}catch(e){console.log("⚠️ No se pudo verificar el estado del permiso, asumiendo disponible")}return!0}let e=await i.L.checkPermissions();return"granted"===e.location}catch(e){return console.error("Error checking location permission:",e),!1}},g=async()=>{try{if(!t.Ii.isNativePlatform())return"mediaDevices"in navigator&&"getUserMedia"in navigator.mediaDevices;let e=await n.i7.checkPermissions();return"granted"===e.camera}catch(e){return console.error("Error checking camera permission:",e),!1}},f=async()=>{try{if(!t.Ii.isNativePlatform())return"mediaDevices"in navigator&&"getUserMedia"in navigator.mediaDevices;try{return(await navigator.mediaDevices.getUserMedia({audio:!0})).getTracks().forEach(e=>e.stop()),!0}catch(e){return!1}}catch(e){return console.error("Error checking microphone permission:",e),!1}},p=async()=>{try{if(r(e=>({...e,hasAskedBefore:{...e.hasAskedBefore,location:!0},isLoading:!0,error:null})),!t.Ii.isNativePlatform()){if(!("geolocation"in navigator))return r(e=>({...e,location:!1,isLoading:!1,error:"Geolocalizaci\xf3n no disponible en este navegador"})),!1;return console.log("\uD83D\uDD04 Solicitando permiso de geolocalizaci\xf3n..."),new Promise(e=>{navigator.geolocation.getCurrentPosition(a=>{console.log("✅ Permiso de geolocalizaci\xf3n concedido:",a),r(e=>({...e,location:!0,isLoading:!1,error:null})),e(!0)},a=>{console.error("❌ Error en solicitud de geolocalizaci\xf3n:",a);let o="Error al acceder a la ubicaci\xf3n",i=!1;switch(a.code){case a.PERMISSION_DENIED:o='Permiso de ubicaci\xf3n denegado. Para activarlo:\n1. Haz clic en el \xedcono de ubicaci\xf3n en la barra de direcciones\n2. Selecciona "Permitir" para este sitio\n3. Recarga la p\xe1gina si es necesario',i=!0;break;case a.POSITION_UNAVAILABLE:o="Ubicaci\xf3n no disponible. Verifica que:\n1. Tu dispositivo tenga GPS activado\n2. Est\xe9s en un lugar con buena se\xf1al\n3. El navegador tenga acceso a servicios de ubicaci\xf3n";break;case a.TIMEOUT:o="Tiempo de espera agotado. Intenta:\n1. Verificar tu conexi\xf3n a internet\n2. Activar el GPS de tu dispositivo\n3. Intentar nuevamente";break;default:o="Error desconocido al obtener ubicaci\xf3n. Intenta recargar la p\xe1gina."}r(e=>({...e,location:!1,isLoading:!1,deniedPermanently:{...e.deniedPermanently,location:i},error:o})),e(!1)},{timeout:1e4,enableHighAccuracy:!1,maximumAge:6e5})})}let e=await i.L.requestPermissions(),a="granted"===e.location,o="denied"===e.location;return r(e=>({...e,location:a,isLoading:!1,deniedPermanently:{...e.deniedPermanently,location:o},error:o?"Permiso de ubicaci\xf3n denegado. Habil\xedtalo en la configuraci\xf3n de la aplicaci\xf3n.":null})),a}catch(a){console.error("Error requesting location permission:",a);let e=a instanceof Error?a.message:"Error desconocido al solicitar permiso de ubicaci\xf3n";return r(r=>({...r,location:!1,isLoading:!1,error:e})),!1}},v=async()=>{try{if(r(e=>({...e,hasAskedBefore:{...e.hasAskedBefore,camera:!0}})),!t.Ii.isNativePlatform())try{return(await navigator.mediaDevices.getUserMedia({video:!0})).getTracks().forEach(e=>e.stop()),r(e=>({...e,camera:!0})),!0}catch(a){let e=(null==a?void 0:a.name)==="NotAllowedError";return r(r=>({...r,camera:!1,deniedPermanently:{...r.deniedPermanently,camera:e},error:e?"Permiso de c\xe1mara denegado. Puedes habilitarlo haciendo clic en el \xedcono de c\xe1mara en la barra de direcciones.":"Error al acceder a la c\xe1mara"})),!1}let e=await n.i7.requestPermissions(),a="granted"===e.camera,o="denied"===e.camera;return r(e=>({...e,camera:a,deniedPermanently:{...e.deniedPermanently,camera:o},error:o?"Para tomar fotos, habilita la c\xe1mara en Configuraci\xf3n > Aplicaciones > SquadGO > Permisos":null})),a}catch(e){return console.error("Error requesting camera permission:",e),r(e=>({...e,error:"Error al solicitar permiso de c\xe1mara. Int\xe9ntalo de nuevo."})),!1}},h=async()=>{try{if(r(e=>({...e,hasAskedBefore:{...e.hasAskedBefore,microphone:!0}})),!t.Ii.isNativePlatform())try{return(await navigator.mediaDevices.getUserMedia({audio:!0})).getTracks().forEach(e=>e.stop()),r(e=>({...e,microphone:!0})),!0}catch(a){let e=(null==a?void 0:a.name)==="NotAllowedError";return r(r=>({...r,microphone:!1,deniedPermanently:{...r.deniedPermanently,microphone:e},error:e?"Permiso de micr\xf3fono denegado. Puedes habilitarlo haciendo clic en el \xedcono de micr\xf3fono en la barra de direcciones.":"Error al acceder al micr\xf3fono"})),!1}try{return(await navigator.mediaDevices.getUserMedia({audio:!0})).getTracks().forEach(e=>e.stop()),r(e=>({...e,microphone:!0})),!0}catch(a){let e=(null==a?void 0:a.name)==="NotAllowedError";return r(r=>({...r,microphone:!1,deniedPermanently:{...r.deniedPermanently,microphone:e},error:e?"Para usar mensajes de voz, habilita el micr\xf3fono en Configuraci\xf3n > Aplicaciones > SquadGO > Permisos":"Error al acceder al micr\xf3fono"})),!1}}catch(e){return console.error("Error requesting microphone permission:",e),r(e=>({...e,error:"Error al solicitar permiso de micr\xf3fono. Int\xe9ntalo de nuevo."})),!1}},b=async()=>{try{r(e=>({...e,isLoading:!0,error:null}));let[e,a,o]=await Promise.all([p(),v(),h()]),i=e&&a&&o;return r(r=>({...r,location:e,camera:a,microphone:o,isLoading:!1,error:i?null:"Algunos permisos no fueron concedidos"})),i}catch(e){return r(e=>({...e,isLoading:!1,error:"Error al solicitar permisos"})),!1}},y=async()=>{try{let a;if(r(e=>({...e,isLoading:!0,error:null})),!e.location&&!await p())throw Error("Permiso de ubicaci\xf3n denegado");a=t.Ii.isNativePlatform()?await i.L.getCurrentPosition({enableHighAccuracy:!0,timeout:15e3}):await new Promise((e,r)=>{if(!("geolocation"in navigator))return void r(Error("Geolocalizaci\xf3n no disponible en este navegador"));navigator.geolocation.getCurrentPosition(r=>e(r),e=>{let a="Error al obtener ubicaci\xf3n";switch(e.code){case e.PERMISSION_DENIED:a="Permiso de ubicaci\xf3n denegado";break;case e.POSITION_UNAVAILABLE:a="Ubicaci\xf3n no disponible. Verifica tu GPS";break;case e.TIMEOUT:a="Tiempo de espera agotado. Intenta nuevamente"}r(Error(a))},{enableHighAccuracy:!0,timeout:15e3,maximumAge:3e5})});let o=null;try{o=await c(a.coords.latitude,a.coords.longitude)}catch(e){console.warn("Error obteniendo informaci\xf3n de geocodificaci\xf3n:",e)}r(e=>({...e,isLoading:!1}));let n={latitude:a.coords.latitude,longitude:a.coords.longitude,accuracy:a.coords.accuracy,locationInfo:o,source:t.Ii.isNativePlatform()?"gps":"network",timestamp:Date.now()};return l(n),n}catch(o){console.error("Error getting location:",o);let e=o instanceof Error?o.message:"Error desconocido al obtener ubicaci\xf3n";if(r(r=>({...r,isLoading:!1,error:e})),a&&Date.now()-(a.timestamp||0)<36e5)return console.log("Usando ubicaci\xf3n cacheada como respaldo"),{...a,source:"cached"};throw Error(e)}},P=()=>{var e,r;return s?{latitude:(null==(e=s.coordinates)?void 0:e.latitude)||0,longitude:(null==(r=s.coordinates)?void 0:r.longitude)||0,accuracy:1e4,locationInfo:{city:s.city,state:s.region||"Unknown",country:s.country||"Unknown",fullAddress:"".concat(s.city,", ").concat(s.region||"Unknown",", ").concat(s.country||"Unknown")},source:"manual",timestamp:Date.now()}:null},E=()=>a?Date.now()-(a.timestamp||0)>36e5?(l(null),null):{...a,source:"cached"}:null,w=async()=>{try{return await y()}catch(a){console.warn("GPS fall\xf3, intentando respaldos:",a);let e=E();if(e)return console.log("Usando ubicaci\xf3n cacheada"),e;let r=P();if(r&&0!==r.latitude&&0!==r.longitude)return console.log("Usando ubicaci\xf3n manual"),r;throw a}},k=async()=>{try{if(!e.camera&&!await v())throw Error("Permiso de c\xe1mara denegado");return await n.i7.getPhoto({quality:90,allowEditing:!1,resultType:n.LK.Uri,source:n.ru.Camera})}catch(e){throw console.error("Error taking photo:",e),e}};return{permissions:e,checkAllPermissions:u,requestLocationPermission:p,requestCameraPermission:v,requestMicrophonePermission:h,requestAllPermissions:b,getCurrentLocation:y,getLocationWithFallback:w,setManualLocationData:e=>{d(e),r(e=>({...e,error:null}))},getManualLocation:P,getCachedLocation:E,clearLocationCache:()=>{l(null),d(null)},cachedLocation:a,manualLocation:s,takePhoto:k}}},55365:(e,r,a)=>{a.d(r,{Fc:()=>l,TN:()=>d,XL:()=>s});var o=a(95155),i=a(12115),n=a(74466),t=a(59434);let c=(0,n.F)("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),l=i.forwardRef((e,r)=>{let{className:a,variant:i,...n}=e;return(0,o.jsx)("div",{ref:r,role:"alert",className:(0,t.cn)(c({variant:i}),a),...n})});l.displayName="Alert";let s=i.forwardRef((e,r)=>{let{className:a,...i}=e;return(0,o.jsx)("h5",{ref:r,className:(0,t.cn)("mb-1 font-medium leading-none tracking-tight",a),...i})});s.displayName="AlertTitle";let d=i.forwardRef((e,r)=>{let{className:a,...i}=e;return(0,o.jsx)("div",{ref:r,className:(0,t.cn)("text-sm [&_p]:leading-relaxed",a),...i})});d.displayName="AlertDescription"},62523:(e,r,a)=>{a.d(r,{p:()=>t});var o=a(95155),i=a(12115),n=a(59434);let t=i.forwardRef((e,r)=>{let{className:a,type:i,...t}=e;return(0,o.jsx)("input",{type:i,className:(0,n.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",a),ref:r,...t})});t.displayName="Input"}}]);