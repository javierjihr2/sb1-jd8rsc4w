(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4059],{17313:(e,s,a)=>{"use strict";a.d(s,{Xi:()=>o,av:()=>d,j7:()=>c,tU:()=>n});var t=a(95155),i=a(12115),r=a(60704),l=a(59434);let n=r.bL,c=i.forwardRef((e,s)=>{let{className:a,...i}=e;return(0,t.jsx)(r.B8,{ref:s,className:(0,l.cn)("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",a),...i})});c.displayName=r.B8.displayName;let o=i.forwardRef((e,s)=>{let{className:a,...i}=e;return(0,t.jsx)(r.l9,{ref:s,className:(0,l.cn)("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",a),...i})});o.displayName=r.l9.displayName;let d=i.forwardRef((e,s)=>{let{className:a,...i}=e;return(0,t.jsx)(r.UC,{ref:s,className:(0,l.cn)("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",a),...i})});d.displayName=r.UC.displayName},22424:(e,s,a)=>{"use strict";a.d(s,{Ds:()=>g,Hv:()=>h,Jv:()=>m,Ss:()=>o,bA:()=>d,hR:()=>x,mT:()=>f,ul:()=>u});var t=a(56104),i=a(35317),r=a(6033),l=a(68598);async function n(e){try{let s=(0,l.Ip)(e);if(!s.isValid)return{success:!1,error:s.errors.join(", ")};let a={...e,createdAt:new Date,expiresAt:e.expiresAt||new Date(Date.now()+6048e5)},r=await (0,i.gS)((0,i.rJ)(t.db,"notifications"),a),n=(0,i.P)((0,i.rJ)(t.db,"notificationSubscriptions"),(0,i._M)("userId","==",e.userId),(0,i._M)("active","==",!0)),o=(await (0,i.GG)(n)).docs.map(async e=>{let s=e.data();try{await c(s,a)}catch(s){console.error("Error sending to device:",s),await (0,i.mZ)((0,i.H9)(t.db,"notificationSubscriptions",e.id),{active:!1})}});return await Promise.allSettled(o),{success:!0,notificationId:r.id}}catch(a){console.error("Error sending push notification:",a);let s=r.$2.messageSend(e.userId,{operation:"sendPushNotification",notification:e},"high"===e.priority?"high":"medium");return{success:!1,error:a instanceof Error?a.message:"Unknown error",retryId:s}}}async function c(e,s){console.log("Sending notification to device:",{endpoint:e.endpoint,notification:{title:s.title,body:s.body,data:s.data}}),await new Promise(e=>setTimeout(e,100))}async function o(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:20,a=arguments.length>2&&void 0!==arguments[2]&&arguments[2];try{let r=(0,i.P)((0,i.rJ)(t.db,"notifications"),(0,i._M)("userId","==",e),(0,i.My)("createdAt","desc"),(0,i.AB)(s));a&&(r=(0,i.P)((0,i.rJ)(t.db,"notifications"),(0,i._M)("userId","==",e),(0,i._M)("read","==",!1),(0,i.My)("createdAt","desc"),(0,i.AB)(s)));let l=(await (0,i.GG)(r)).docs.map(e=>({id:e.id,...e.data()}));return{success:!0,notifications:l}}catch(e){return console.error("Error getting user notifications:",e),{success:!1,error:e instanceof Error?e.message:"Unknown error"}}}async function d(e){try{return await (0,i.mZ)((0,i.H9)(t.db,"notifications",e),{read:!0}),{success:!0}}catch(a){console.error("Error marking notification as read:",a);let s=r.$2.messageSend("system",{operation:"markNotificationAsRead",notificationId:e},"low");return{success:!1,error:a instanceof Error?a.message:"Unknown error",retryId:s}}}function m(e,s){let a=(0,i.P)((0,i.rJ)(t.db,"notifications"),(0,i._M)("userId","==",e),(0,i.My)("createdAt","desc"),(0,i.AB)(50));return(0,i.aQ)(a,e=>{s(e.docs.map(e=>({id:e.id,...e.data()})))})}async function u(e){try{let s=(0,i.P)((0,i.rJ)(t.db,"notifications"),(0,i._M)("userId","==",e),(0,i._M)("read","==",!1)),a=await (0,i.GG)(s);return{success:!0,count:a.size}}catch(e){return console.error("Error getting unread notification count:",e),{success:!1,error:e instanceof Error?e.message:"Unknown error"}}}async function h(e,s,a,t){return n({userId:e,type:"message",title:"Nuevo mensaje de ".concat(s),body:a,data:{chatId:t,type:"message"},read:!1,priority:"high",actionUrl:"/chats/".concat(t)})}async function x(e,s,a){return n({userId:e,type:"friend_request",title:"Nueva solicitud de amistad",body:"".concat(s," te ha enviado una solicitud de amistad"),data:{senderId:a,type:"friend_request"},read:!1,priority:"normal",actionUrl:"/friends"})}async function g(e,s,a,t){try{let i,r,l="normal";switch(a){case"registered":i="Registro confirmado",r="Te has registrado exitosamente en ".concat(s);break;case"waitlisted":i="En lista de espera",r="Has sido agregado a la lista de espera de ".concat(s);break;case"moved-from-waitlist":i="\xa1Registro confirmado!",r="Has sido movido de la lista de espera a participante activo en ".concat(s),l="high";break;case"tournament-starting":i="Torneo iniciando",r="".concat(s," est\xe1 a punto de comenzar"),l="high";break;case"tournament-cancelled":i="Torneo cancelado",r="".concat(s," ha sido cancelado"),l="high";break;default:i="Actualizaci\xf3n de torneo",r="Hay una actualizaci\xf3n sobre ".concat(s)}return await n({userId:e,type:"tournament_invite",title:i,body:r,priority:l,read:!1,actionUrl:"/tournaments/".concat(t),data:{tournamentId:t,tournamentTitle:s,notificationType:a,type:"tournament"}})}catch(e){return console.error("Error sending tournament notification:",e),{success:!1,error:"Failed to send tournament notification"}}}async function f(){try{if(!("Notification"in window))return{success:!1,error:"Este navegador no soporta notificaciones"};if("granted"===Notification.permission)return{success:!0,permission:"granted"};let e=await Notification.requestPermission();return{success:"granted"===e,permission:e,error:"denied"===e?"Permisos de notificaci\xf3n denegados":void 0}}catch(e){return console.error("Error requesting notification permission:",e),{success:!1,error:e instanceof Error?e.message:"Unknown error"}}}},47262:(e,s,a)=>{"use strict";a.d(s,{S:()=>c});var t=a(95155),i=a(12115),r=a(76981),l=a(10518),n=a(59434);let c=i.forwardRef((e,s)=>{let{className:a,...i}=e;return(0,t.jsx)(r.bL,{ref:s,className:(0,n.cn)("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",a),...i,children:(0,t.jsx)(r.C1,{className:(0,n.cn)("flex items-center justify-center text-current"),children:(0,t.jsx)(l.A,{className:"h-4 w-4"})})})});c.displayName=r.bL.displayName},54165:(e,s,a)=>{"use strict";a.d(s,{Cf:()=>u,Es:()=>x,L3:()=>g,c7:()=>h,lG:()=>c,rr:()=>f,zM:()=>o});var t=a(95155),i=a(12115),r=a(45821),l=a(25318),n=a(59434);let c=r.bL,o=r.l9,d=r.ZL;r.bm;let m=i.forwardRef((e,s)=>{let{className:a,...i}=e;return(0,t.jsx)(r.hJ,{ref:s,className:(0,n.cn)("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",a),...i})});m.displayName=r.hJ.displayName;let u=i.forwardRef((e,s)=>{let{className:a,children:i,...c}=e;return(0,t.jsxs)(d,{children:[(0,t.jsx)(m,{}),(0,t.jsxs)(r.UC,{ref:s,className:(0,n.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",a),...c,children:[i,(0,t.jsxs)(r.bm,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,t.jsx)(l.A,{className:"h-4 w-4"}),(0,t.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})});u.displayName=r.UC.displayName;let h=e=>{let{className:s,...a}=e;return(0,t.jsx)("div",{className:(0,n.cn)("flex flex-col space-y-1.5 text-center sm:text-left",s),...a})};h.displayName="DialogHeader";let x=e=>{let{className:s,...a}=e;return(0,t.jsx)("div",{className:(0,n.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",s),...a})};x.displayName="DialogFooter";let g=i.forwardRef((e,s)=>{let{className:a,...i}=e;return(0,t.jsx)(r.hE,{ref:s,className:(0,n.cn)("text-lg font-semibold leading-none tracking-tight",a),...i})});g.displayName=r.hE.displayName;let f=i.forwardRef((e,s)=>{let{className:a,...i}=e;return(0,t.jsx)(r.VY,{ref:s,className:(0,n.cn)("text-sm text-muted-foreground",a),...i})});f.displayName=r.VY.displayName},59409:(e,s,a)=>{"use strict";a.d(s,{bq:()=>h,eb:()=>p,gC:()=>f,l6:()=>d,s3:()=>m,yv:()=>u});var t=a(95155),i=a(12115),r=a(43433),l=a(79556),n=a(77381),c=a(10518),o=a(59434);let d=r.bL,m=r.YJ,u=r.WT,h=i.forwardRef((e,s)=>{let{className:a,children:i,...n}=e;return(0,t.jsxs)(r.l9,{ref:s,className:(0,o.cn)("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",a),...n,children:[i,(0,t.jsx)(r.In,{asChild:!0,children:(0,t.jsx)(l.A,{className:"h-4 w-4 opacity-50"})})]})});h.displayName=r.l9.displayName;let x=i.forwardRef((e,s)=>{let{className:a,...i}=e;return(0,t.jsx)(r.PP,{ref:s,className:(0,o.cn)("flex cursor-default items-center justify-center py-1",a),...i,children:(0,t.jsx)(n.A,{className:"h-4 w-4"})})});x.displayName=r.PP.displayName;let g=i.forwardRef((e,s)=>{let{className:a,...i}=e;return(0,t.jsx)(r.wn,{ref:s,className:(0,o.cn)("flex cursor-default items-center justify-center py-1",a),...i,children:(0,t.jsx)(l.A,{className:"h-4 w-4"})})});g.displayName=r.wn.displayName;let f=i.forwardRef((e,s)=>{let{className:a,children:i,position:l="popper",...n}=e;return(0,t.jsx)(r.ZL,{children:(0,t.jsxs)(r.UC,{ref:s,className:(0,o.cn)("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===l&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",a),position:l,...n,children:[(0,t.jsx)(x,{}),(0,t.jsx)(r.LM,{className:(0,o.cn)("p-1","popper"===l&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:i}),(0,t.jsx)(g,{})]})})});f.displayName=r.UC.displayName,i.forwardRef((e,s)=>{let{className:a,...i}=e;return(0,t.jsx)(r.JU,{ref:s,className:(0,o.cn)("py-1.5 pl-8 pr-2 text-sm font-semibold",a),...i})}).displayName=r.JU.displayName;let p=i.forwardRef((e,s)=>{let{className:a,children:i,...l}=e;return(0,t.jsxs)(r.q7,{ref:s,className:(0,o.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",a),...l,children:[(0,t.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,t.jsx)(r.VF,{children:(0,t.jsx)(c.A,{className:"h-4 w-4"})})}),(0,t.jsx)(r.p4,{children:i})]})});p.displayName=r.q7.displayName,i.forwardRef((e,s)=>{let{className:a,...i}=e;return(0,t.jsx)(r.wv,{ref:s,className:(0,o.cn)("-mx-1 my-1 h-px bg-muted",a),...i})}).displayName=r.wv.displayName},59434:(e,s,a)=>{"use strict";a.d(s,{cn:()=>r});var t=a(52596),i=a(39688);function r(){for(var e=arguments.length,s=Array(e),a=0;a<e;a++)s[a]=arguments[a];return(0,i.QP)((0,t.$)(s))}},63055:(e,s,a)=>{Promise.resolve().then(a.bind(a,70052))},67491:(e,s,a)=>{"use strict";a.d(s,{A:()=>o,AuthProvider:()=>c});var t=a(95155),i=a(12115),r=a(24903),l=a(56104);let n=(0,i.createContext)({user:null,loading:!0}),c=e=>{let{children:s}=e,[a,c]=(0,i.useState)(null),[o,d]=(0,i.useState)(!0);return(0,i.useEffect)(()=>{console.log("\uD83D\uDD27 AuthProvider - Configurando listener de autenticaci\xf3n"),(()=>{{let e=localStorage.getItem("squadgo_user"),s=localStorage.getItem("squadgo_user_backup");if(e||s)try{let a=JSON.parse(e||s||"{}");console.log("\uD83D\uDD04 AuthProvider - Intentando recuperar sesi\xf3n desde localStorage:",a.uid)}catch(e){console.error("❌ Error recuperando usuario desde localStorage:",e),localStorage.removeItem("squadgo_user"),localStorage.removeItem("squadgo_user_backup")}}})();let e=(0,r.onAuthStateChanged)(l.j2,async e=>{if(console.log("\uD83D\uDD04 AuthProvider - Estado de autenticaci\xf3n cambi\xf3:",{uid:null==e?void 0:e.uid,email:null==e?void 0:e.email,emailVerified:null==e?void 0:e.emailVerified}),e)try{console.log("✅ AuthProvider - Usuario autenticado"),c(e);{let s={uid:e.uid,email:e.email||"",displayName:e.displayName||"",photoURL:e.photoURL||"",emailVerified:e.emailVerified,lastUpdate:Date.now(),sessionId:Math.random().toString(36).substring(2,11)};localStorage.setItem("squadgo_user",JSON.stringify(s)),localStorage.setItem("squadgo_user_backup",JSON.stringify(s));let a=new CustomEvent("userAuthenticated",{detail:{user:e}});window.dispatchEvent(a)}}catch(e){console.error("❌ AuthProvider - Error procesando usuario:",e),c(null),localStorage.removeItem("squadgo_user"),localStorage.removeItem("squadgo_user_backup")}else{console.log("\uD83D\uDEAB AuthProvider - Usuario no autenticado"),c(null);{let e=localStorage.getItem("squadgo_user_backup");if(e)try{let s=JSON.parse(e);Date.now()-(s.lastUpdate||0)>864e5?(localStorage.removeItem("squadgo_user"),localStorage.removeItem("squadgo_user_backup"),console.log("\uD83E\uDDF9 Limpiando datos de sesi\xf3n expirados")):console.log("\uD83D\uDD04 Manteniendo backup de sesi\xf3n reciente")}catch(e){localStorage.removeItem("squadgo_user"),localStorage.removeItem("squadgo_user_backup")}else localStorage.removeItem("squadgo_user")}}d(!1)});return()=>{console.log("\uD83E\uDDF9 AuthProvider - Limpiando listener de autenticaci\xf3n"),e()}},[]),(0,t.jsx)(n.Provider,{value:{user:a,loading:o},children:s})},o=()=>(0,i.useContext)(n)},68856:(e,s,a)=>{"use strict";a.d(s,{E:()=>r});var t=a(95155),i=a(59434);function r(e){let{className:s,...a}=e;return(0,t.jsx)("div",{className:(0,i.cn)("animate-pulse rounded-md bg-muted",s),...a})}},70052:(e,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>Y});var t=a(95155),i=a(12115),r=a(30285),l=a(66695),n=a(85057),c=a(59409),o=a(47262),d=a(26126),m=a(91394),u=a(17313),h=a(54165),x=a(88539),g=a(87481),f=a(68856),p=a(35317),v=a(56104),j=a(6033),y=a(68598),b=a(22424);let N={maxResults:50,minCompatibility:50,locationRadius:100,requestExpiryHours:24,maxSkillLevelDiff:2,recentActivityDays:7};async function w(e){try{let s=(0,y.VA)(e);if(!s.isValid)return{success:!1,error:s.errors.join(", ")};let a={...s.sanitizedData,createdAt:(0,p.O5)(),updatedAt:(0,p.O5)(),lastActive:(0,p.O5)()},t=await (0,p.gS)((0,p.rJ)(v.db,"matchingProfiles"),a);return{success:!0,profileId:t.id}}catch(a){console.error("Error creating matching profile:",a);let s=j.$2.profileUpdate(e.userId,e,"medium");return{success:!1,error:a.message,retryId:s}}}async function k(e,s,a){try{let t=(0,p.P)((0,p.rJ)(v.db,"matchingProfiles"),(0,p._M)("userId","==",e),(0,p._M)("isActive","==",!0)),i=await (0,p.GG)(t);if(i.empty)return{success:!1,error:"Perfil de matching no encontrado"};let r={id:i.docs[0].id,...i.docs[0].data()},l=(0,p.P)((0,p.rJ)(v.db,"matchingProfiles"),(0,p._M)("isActive","==",!0),(0,p._M)("userId","!=",e));if(s&&(l=(0,p.P)(l,(0,p._M)("games","array-contains",s))),(null==a?void 0:a.lookingFor)&&(l=(0,p.P)(l,(0,p._M)("lookingFor","==",a.lookingFor))),null==a?void 0:a.recentlyActive){let e=new Date;e.setDate(e.getDate()-N.recentActivityDays),l=(0,p.P)(l,(0,p._M)("lastActive",">=",e))}let n=(await (0,p.GG)(l)).docs.map(e=>({id:e.id,...e.data()}));(null==a?void 0:a.languages)&&a.languages.length>0&&(n=n.filter(e=>e.languages.some(e=>a.languages.includes(e)))),(null==a?void 0:a.ageRange)&&(n=n.filter(e=>{let s=r.ageRange,t=e.ageRange;return s.min<=t.max&&s.max>=t.min&&a.ageRange.min<=t.max&&a.ageRange.max>=t.min})),(null==a?void 0:a.communicationPrefs)&&a.communicationPrefs.length>0&&(n=n.filter(e=>{let s=e.communicationPrefs;return a.communicationPrefs.some(e=>{switch(e){case"voiceChat":return s.voiceChat;case"textOnly":return s.textOnly;case"discord":return s.discord;case"inGame":return s.inGame;default:return!1}})})),(null==a?void 0:a.teamSize)&&(n=n.filter(e=>1>=Math.abs(e.teamSize-a.teamSize)));let c=n.map(e=>A(r,e)).filter(e=>e.compatibility>=N.minCompatibility).sort((e,s)=>{let a=s.compatibility+5*!!R(s.profile),t=e.compatibility+5*!!R(e.profile);return a-t}).slice(0,N.maxResults);return{success:!0,matches:c}}catch(e){return console.error("Error finding matches:",e),{success:!1,error:e.message}}}function A(e,s){let a=0,t=[],i=e.games.filter(e=>s.games.includes(e));i.length>0&&(a+=35*(i.length/Math.max(e.games.length,s.games.length)),t.push("".concat(i.length," juego(s) en com\xfan")));let r=0,l=0;i.forEach(a=>{let t=e.skillLevels[a],i=s.skillLevels[a];if(t&&i){let e=["beginner","intermediate","advanced","pro"],s=Math.abs(e.indexOf(t)-e.indexOf(i));s<=N.maxSkillLevelDiff&&(r+=Math.max(0,1-s/3),l++)}}),l>0&&(a+=r/l*20,t.push("Nivel de habilidad compatible"));let n=function(e,s){let a=0;(e.weekdays&&s.weekdays||e.weekends&&s.weekends)&&(a+=.5);let t=e.preferredTimes.filter(e=>s.preferredTimes.includes(e));return t.length>0&&(a+=.5*(t.length/Math.max(e.preferredTimes.length,s.preferredTimes.length))),Math.min(1,a)}(e.availability,s.availability);a+=15*n,n>.5&&t.push("Horarios compatibles");let c=e.languages.filter(e=>s.languages.includes(e));c.length>0&&(a+=10,t.push("Idioma(s) en com\xfan: ".concat(c.join(", "))));let o=e.communicationPrefs,d=s.communicationPrefs,m=0;o.voiceChat&&d.voiceChat&&(m+=3),o.discord&&d.discord&&(m+=3),o.inGame&&d.inGame&&(m+=2),o.textOnly&&d.textOnly&&(m+=2),a+=m,m>0&&t.push("Preferencias de comunicaci\xf3n compatibles"),(e.lookingFor===s.lookingFor||"any"===e.lookingFor||"any"===s.lookingFor)&&(a+=5,t.push("Mismo tipo de juego buscado"));let u=new Date,h=(u.getTime()-e.lastActive.toDate().getTime())/864e5,x=(u.getTime()-s.lastActive.toDate().getTime())/864e5;return h<=N.recentActivityDays&&x<=N.recentActivityDays&&(a+=5,t.push("Ambos usuarios activos recientemente")),i.length>=3&&c.length>=2&&n>.8&&(a*=1.1,t.push("Compatibilidad excepcional")),{profile:s,compatibility:Math.round(Math.min(100,a)),commonGames:i,reasons:t}}function R(e){return(new Date().getTime()-e.lastActive.toDate().getTime())/864e5<=N.recentActivityDays}async function M(e){try{let s=(0,y.Vy)(e);if(!s.isValid)return{success:!1,error:s.errors.join(", ")};let a=s.sanitizedData,t={...a,createdAt:(0,p.O5)(),expiresAt:new Date(Date.now()+60*N.requestExpiryHours*6e4)},i=await (0,p.gS)((0,p.rJ)(v.db,"matchRequests"),t);try{await (0,b.hR)(a.toUserId,"Usuario",a.fromUserId)}catch(e){console.error("Error sending match request notification:",e)}return{success:!0,requestId:i.id}}catch(a){console.error("Error sending match request:",a);let s=j.$2.messageSend(e.fromUserId,{operation:"sendMatchRequest",data:e},"high");return{success:!1,error:a.message,retryId:s}}}async function S(e,s){try{return await (0,p.mZ)((0,p.H9)(v.db,"matchRequests",e),{status:s,updatedAt:(0,p.O5)()}),{success:!0}}catch(e){return console.error("Error responding to match request:",e),{success:!1,error:e.message}}}async function C(e){try{let s=(0,p.P)((0,p.rJ)(v.db,"matchRequests"),(0,p._M)("toUserId","==",e)),a=await (0,p.GG)(s),t=a.docs.filter(e=>"accepted"===e.data().status).length,i=(0,p.P)((0,p.rJ)(v.db,"matchRequests"),(0,p._M)("fromUserId","==",e)),r=await (0,p.GG)(i);return{totalMatches:a.size,acceptedRequests:t,sentRequests:r.size,profileViews:0}}catch(e){return console.error("Error getting matching stats:",e),{totalMatches:0,acceptedRequests:0,sentRequests:0,profileViews:0}}}async function E(e,s){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:N.locationRadius;try{let t=(0,p.P)((0,p.rJ)(v.db,"matchingProfiles"),(0,p._M)("userId","==",e),(0,p._M)("isActive","==",!0)),i=await (0,p.GG)(t);if(i.empty)return{success:!1,error:"Perfil de matching no encontrado"};let r={id:i.docs[0].id,...i.docs[0].data()},l=(0,p.P)((0,p.rJ)(v.db,"matchingProfiles"),(0,p._M)("isActive","==",!0),(0,p._M)("userId","!=",e),(0,p._M)("location.coordinates","!=",null)),n=await (0,p.GG)(l),c=[];n.docs.forEach(e=>{var t;let i={id:e.id,...e.data()};(null==(t=i.location)?void 0:t.coordinates)&&q(s.lat,s.lng,i.location.coordinates.latitude,i.location.coordinates.longitude)<=a&&c.push(i)});let o=c.map(e=>{let t=A(r,e),i=q(s.lat,s.lng,e.location.coordinates.latitude,e.location.coordinates.longitude),l=Math.max(0,10-i/a*10);return t.compatibility+=l,t.reasons.push("A ".concat(i.toFixed(1),"km de distancia")),t}).filter(e=>e.compatibility>=N.minCompatibility).sort((e,s)=>s.compatibility-e.compatibility).slice(0,N.maxResults);return{success:!0,matches:o}}catch(e){return console.error("Error finding matches by location:",e),{success:!1,error:e.message}}}function q(e,s,a,t){let i=(a-e)*Math.PI/180,r=(t-s)*Math.PI/180,l=Math.sin(i/2)*Math.sin(i/2)+Math.cos(e*Math.PI/180)*Math.cos(a*Math.PI/180)*Math.sin(r/2)*Math.sin(r/2);return 2*Math.atan2(Math.sqrt(l),Math.sqrt(1-l))*6371}async function P(e){try{let s=(0,p.P)((0,p.rJ)(v.db,"matchRequests"),(0,p._M)("toUserId","==",e),(0,p._M)("status","==","accepted"),(0,p.My)("createdAt","desc"),(0,p.AB)(10)),a=(await (0,p.GG)(s)).docs.map(e=>e.data()),t={};a.forEach(e=>{t[e.game]=(t[e.game]||0)+1});let i=Object.keys(t).sort((e,s)=>t[s]-t[e]).slice(0,3);if(0===i.length)return k(e);let r=[];for(let s of i){let a=await k(e,s,{recentlyActive:!0});a.success&&a.matches&&r.push(...a.matches.slice(0,5))}let l=r.filter((e,s,a)=>s===a.findIndex(s=>s.profile.userId===e.profile.userId)).sort((e,s)=>s.compatibility-e.compatibility).slice(0,N.maxResults);return{success:!0,recommendations:l}}catch(e){return console.error("Error getting smart recommendations:",e),{success:!1,error:e.message}}}async function I(e){try{let s=await C(e),a=(0,p.P)((0,p.rJ)(v.db,"matchRequests"),(0,p._M)("fromUserId","==",e),(0,p.My)("createdAt","desc"),(0,p.AB)(20)),t=(await (0,p.GG)(a)).docs.map(e=>e.data()),i={},r=0;t.forEach(e=>{i[e.game]=(i[e.game]||0)+1,"accepted"===e.status&&r++});let l=Object.entries(i).map(e=>{let[s,a]=e;return{game:s,matches:a}}).sort((e,s)=>s.matches-e.matches).slice(0,5),n=t.length>0?r/t.length*100:0;return{...s,averageCompatibility:0/Math.max(1,t.length),topGames:l,successRate:n}}catch(e){return console.error("Error getting advanced stats:",e),{totalMatches:0,acceptedRequests:0,sentRequests:0,profileViews:0,averageCompatibility:0,topGames:[],successRate:0}}}var _=a(85268),T=a(50286),J=a(75074),G=a(83662),U=a(74601),D=a(50172),O=a(30462),L=a(94063),z=a(18271),V=a(48646),F=a(68098),B=a(10518),Z=a(25318),$=a(67491);let H=["League of Legends","Valorant","Counter-Strike 2","Dota 2","Overwatch 2","Apex Legends","Fortnite","Rocket League","Call of Duty","FIFA 24"],W=[{value:"beginner",label:"Principiante"},{value:"intermediate",label:"Intermedio"},{value:"advanced",label:"Avanzado"},{value:"pro",label:"Profesional"}],K=[{id:"es",name:"Espa\xf1ol"},{id:"en",name:"Ingl\xe9s"},{id:"pt",name:"Portugu\xe9s"},{id:"fr",name:"Franc\xe9s"}],X=[{value:"morning",label:"Ma\xf1ana (6-12)"},{value:"afternoon",label:"Tarde (12-18)"},{value:"evening",label:"Noche (18-24)"},{value:"night",label:"Madrugada (0-6)"}],Q=[{value:"casual",label:"Casual"},{value:"competitive",label:"Competitivo"},{value:"ranked",label:"Ranked"},{value:"tournaments",label:"Torneos"},{value:"any",label:"Cualquiera"}];function Y(){let{user:e}=(0,$.A)(),{toast:s}=(0,g.dj)(),[a,j]=(0,i.useState)(null),[y,b]=(0,i.useState)(!1),[N,A]=(0,i.useState)({games:[],skillLevels:{},languages:["es"],availability:{timezone:"America/Argentina/Buenos_Aires",preferredTimes:[],weekdays:!0,weekends:!0},lookingFor:"any",teamSize:2,communicationPrefs:{voiceChat:!0,textOnly:!1,discord:!0,inGame:!0}}),[R,q]=(0,i.useState)([]),[Y,ee]=(0,i.useState)([]),[es,ea]=(0,i.useState)({game:"",skillLevel:"",lookingFor:"",ageRange:{min:18,max:35},languages:[],onlineOnly:!1,recentlyActive:!0,communicationPrefs:[],useLocation:!1,location:{lat:0,lng:0},radiusKm:50}),[et,ei]=(0,i.useState)(!1),[er,el]=(0,i.useState)("normal"),[en,ec]=(0,i.useState)([]),[eo,ed]=(0,i.useState)(null),[em,eu]=(0,i.useState)(""),[eh,ex]=(0,i.useState)({totalMatches:0,acceptedRequests:0,sentRequests:0,profileViews:0,averageCompatibility:0,topGames:[],successRate:0});(0,i.useEffect)(()=>{if(e)return eg(),function(e,s){let a=(0,p.P)((0,p.rJ)(v.db,"matchRequests"),(0,p._M)("toUserId","==",e),(0,p._M)("status","==","pending"),(0,p.My)("createdAt","desc"));return(0,p.aQ)(a,e=>{s(e.docs.map(e=>({id:e.id,...e.data()})))})}(e.uid,e=>{ec(e)})},[e]);let eg=async()=>{if(e)try{let s=await I(e.uid);ex({totalMatches:s.totalMatches||0,acceptedRequests:s.acceptedRequests||0,sentRequests:s.sentRequests||0,profileViews:s.profileViews||0,averageCompatibility:s.averageCompatibility||0,topGames:s.topGames||[],successRate:s.successRate||0})}catch(s){console.error("Error loading stats:",s);try{let s=await C(e.uid);ex({totalMatches:s.totalMatches||0,acceptedRequests:s.acceptedRequests||0,sentRequests:s.sentRequests||0,profileViews:s.profileViews||0,averageCompatibility:0,topGames:[],successRate:0})}catch(e){console.error("Error loading basic stats:",e)}}},ef=async()=>{if(e)try{let a={userId:e.uid,username:e.displayName||"Usuario",avatar:e.photoURL||void 0,...N,skillLevels:N.skillLevels,preferredRoles:{},lookingFor:N.lookingFor,ageRange:{min:18,max:35},location:void 0,isActive:!0,lastActive:new Date},t=await w(a);t.success?(s({title:"Perfil creado",description:"Tu perfil de matching ha sido creado exitosamente"}),b(!1)):s({title:"Error",description:t.error||"No se pudo crear el perfil",variant:"destructive"})}catch(e){console.error("Error creating profile:",e),s({title:"Error",description:"Error inesperado al crear el perfil",variant:"destructive"})}},ep=async()=>{if(e){ei(!0);try{let a;switch(er){case"location":if(es.useLocation)a=await E(e.uid,es.location,es.radiusKm);else if(navigator.geolocation)return void navigator.geolocation.getCurrentPosition(async a=>{let t={lat:a.coords.latitude,lng:a.coords.longitude},i=await E(e.uid,t,es.radiusKm);i.success&&i.matches&&(q(i.matches),s({title:"B\xfasqueda por ubicaci\xf3n completada",description:"Se encontraron ".concat(i.matches.length," jugadores cercanos")})),ei(!1)});else throw Error("Geolocalizaci\xf3n no disponible");break;case"smart":(a=await P(e.uid)).success&&a.recommendations&&(ee(a.recommendations),q(a.recommendations),s({title:"Recomendaciones inteligentes",description:"Se encontraron ".concat(a.recommendations.length," recomendaciones personalizadas")}));break;default:a=await k(e.uid,es.game||void 0,{skillLevel:es.skillLevel||void 0,lookingFor:es.lookingFor||void 0,ageRange:es.ageRange,languages:es.languages.length>0?es.languages:void 0,onlineOnly:es.onlineOnly,recentlyActive:es.recentlyActive,communicationPrefs:es.communicationPrefs.length>0?es.communicationPrefs:void 0})}if(a&&a.success&&(a.matches||a.recommendations)){let e=a.matches||a.recommendations||[];q(e),s({title:"B\xfasqueda completada",description:"Se encontraron ".concat(e.length," jugadores compatibles")})}else s({title:"Error en b\xfasqueda",description:(null==a?void 0:a.error)||"No se pudo realizar la b\xfasqueda",variant:"destructive"})}catch(e){console.error("Error searching matches:",e),s({title:"Error",description:"Error inesperado en la b\xfasqueda",variant:"destructive"})}finally{ei(!1)}}},ev=async(a,t)=>{if(e)try{let i=await M({fromUserId:e.uid,toUserId:a,game:t,message:em,status:"pending",matchType:"duo"});i.success?(s({title:"Solicitud enviada",description:"Tu solicitud de match ha sido enviada"}),ed(null),eu("")):s({title:"Error",description:i.error||"No se pudo enviar la solicitud",variant:"destructive"})}catch(e){console.error("Error sending match request:",e),s({title:"Error",description:"Error inesperado al enviar solicitud",variant:"destructive"})}},ej=async(e,a)=>{try{let t=await S(e,a);t.success?(s({title:"accepted"===a?"Solicitud aceptada":"Solicitud rechazada",description:"accepted"===a?"\xa1Genial! Ahora pueden jugar juntos":"Solicitud rechazada"}),ec(s=>s.filter(s=>s.id!==e))):s({title:"Error",description:t.error||"No se pudo procesar la respuesta",variant:"destructive"})}catch(e){console.error("Error responding to request:",e),s({title:"Error",description:"Error inesperado al responder",variant:"destructive"})}},ey=e=>{N.games.includes(e)||A(s=>({...s,games:[...s.games,e]}))},eb=e=>{A(s=>({...s,games:s.games.filter(s=>s!==e)}))},eN=(e,s)=>{A(a=>({...a,skillLevels:{...a.skillLevels,[e]:s}}))};return(0,t.jsxs)("div",{className:"container mx-auto p-6 space-y-6",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-3xl font-bold",children:"Matching de Jugadores"}),(0,t.jsx)("p",{className:"text-muted-foreground",children:"Encuentra compa\xf1eros de equipo perfectos"})]}),(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsxs)(d.E,{variant:"secondary",children:[(0,t.jsx)(_.A,{className:"w-4 h-4 mr-1"}),eh.acceptedRequests," matches"]}),(0,t.jsxs)(d.E,{variant:"outline",children:[(0,t.jsx)(T.A,{className:"w-4 h-4 mr-1"}),eh.totalMatches," solicitudes"]})]})]}),(0,t.jsxs)(u.tU,{defaultValue:"search",className:"space-y-6",children:[(0,t.jsxs)(u.j7,{className:"grid w-full grid-cols-4",children:[(0,t.jsx)(u.Xi,{value:"search",children:"Buscar"}),(0,t.jsx)(u.Xi,{value:"profile",children:"Mi Perfil"}),(0,t.jsxs)(u.Xi,{value:"requests",children:["Solicitudes (",en.length,")"]}),(0,t.jsx)(u.Xi,{value:"stats",children:"Estad\xedsticas"})]}),(0,t.jsxs)(u.av,{value:"search",className:"space-y-6",children:[(0,t.jsxs)(l.Zp,{children:[(0,t.jsx)(l.aR,{children:(0,t.jsxs)(l.ZB,{className:"flex items-center",children:[(0,t.jsx)(J.A,{className:"w-5 h-5 mr-2"}),"Buscar Compa\xf1eros"]})}),(0,t.jsxs)(l.Wu,{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"flex gap-2 mb-4",children:[(0,t.jsxs)(r.$,{variant:"normal"===er?"default":"outline",onClick:()=>el("normal"),size:"sm",children:[(0,t.jsx)(J.A,{className:"mr-2 h-4 w-4"}),"B\xfasqueda Normal"]}),(0,t.jsxs)(r.$,{variant:"location"===er?"default":"outline",onClick:()=>el("location"),size:"sm",children:[(0,t.jsx)(G.A,{className:"mr-2 h-4 w-4"}),"Por Ubicaci\xf3n"]}),(0,t.jsxs)(r.$,{variant:"smart"===er?"default":"outline",onClick:()=>el("smart"),size:"sm",children:[(0,t.jsx)(U.A,{className:"mr-2 h-4 w-4"}),"Recomendaciones"]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)(n.J,{children:"Juego"}),(0,t.jsxs)(c.l6,{value:es.game,onValueChange:e=>ea(s=>({...s,game:e})),children:[(0,t.jsx)(c.bq,{children:(0,t.jsx)(c.yv,{placeholder:"Seleccionar juego"})}),(0,t.jsx)(c.gC,{children:H.map(e=>(0,t.jsx)(c.eb,{value:e,children:e},e))})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(n.J,{children:"Nivel de Habilidad"}),(0,t.jsxs)(c.l6,{value:es.skillLevel,onValueChange:e=>ea(s=>({...s,skillLevel:e})),children:[(0,t.jsx)(c.bq,{children:(0,t.jsx)(c.yv,{placeholder:"Cualquier nivel"})}),(0,t.jsx)(c.gC,{children:W.map(e=>(0,t.jsx)(c.eb,{value:e.value,children:e.label},e.value))})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(n.J,{children:"Tipo de Juego"}),(0,t.jsxs)(c.l6,{value:es.lookingFor,onValueChange:e=>ea(s=>({...s,lookingFor:e})),children:[(0,t.jsx)(c.bq,{children:(0,t.jsx)(c.yv,{placeholder:"Cualquier tipo"})}),(0,t.jsx)(c.gC,{children:Q.map(e=>(0,t.jsx)(c.eb,{value:e.value,children:e.label},e.value))})]})]})]}),(0,t.jsxs)("div",{className:"border rounded-lg p-4 space-y-4",children:[(0,t.jsx)("h4",{className:"font-medium text-sm text-muted-foreground",children:"Filtros Avanzados"}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)(n.J,{children:["Rango de edad: ",es.ageRange.min," - ",es.ageRange.max]}),(0,t.jsxs)("div",{className:"flex gap-2 mt-2",children:[(0,t.jsx)("input",{type:"range",min:"18",max:"50",value:es.ageRange.min,onChange:e=>ea(s=>({...s,ageRange:{...s.ageRange,min:parseInt(e.target.value)}})),className:"flex-1"}),(0,t.jsx)("input",{type:"range",min:"18",max:"50",value:es.ageRange.max,onChange:e=>ea(s=>({...s,ageRange:{...s.ageRange,max:parseInt(e.target.value)}})),className:"flex-1"})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(n.J,{children:"Idiomas"}),(0,t.jsx)("div",{className:"grid grid-cols-2 gap-2 mt-2",children:K.map(e=>(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)(o.S,{checked:es.languages.includes(e.id),onCheckedChange:s=>{ea(a=>({...a,languages:s?[...a.languages,e.id]:a.languages.filter(s=>s!==e.id)}))}}),(0,t.jsx)(n.J,{className:"text-sm",children:e.name})]},e.id))})]})]}),(0,t.jsxs)("div",{className:"flex flex-wrap gap-4",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)(o.S,{checked:es.onlineOnly,onCheckedChange:e=>ea(s=>({...s,onlineOnly:!!e}))}),(0,t.jsx)(n.J,{className:"text-sm",children:"Solo jugadores en l\xednea"})]}),(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)(o.S,{checked:es.recentlyActive,onCheckedChange:e=>ea(s=>({...s,recentlyActive:!!e}))}),(0,t.jsx)(n.J,{className:"text-sm",children:"Activos recientemente"})]})]}),"location"===er&&(0,t.jsxs)("div",{children:[(0,t.jsxs)(n.J,{children:["Radio de b\xfasqueda: ",es.radiusKm," km"]}),(0,t.jsx)("input",{type:"range",min:"5",max:"100",value:es.radiusKm,onChange:e=>ea(s=>({...s,radiusKm:parseInt(e.target.value)})),className:"w-full mt-2"})]})]}),(0,t.jsx)(r.$,{onClick:ep,disabled:et,className:"w-full",children:et?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(D.A,{className:"mr-2 h-4 w-4 animate-spin"}),"Buscando..."]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(J.A,{className:"mr-2 h-4 w-4"}),"location"===er?"Buscar por ubicaci\xf3n":"smart"===er?"Obtener recomendaciones":"Buscar jugadores"]})})]})]}),et?(0,t.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:Array.from({length:6}).map((e,s)=>(0,t.jsx)(l.Zp,{children:(0,t.jsxs)(l.Wu,{className:"p-4",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-3 mb-3",children:[(0,t.jsx)(f.E,{className:"h-10 w-10 rounded-full"}),(0,t.jsxs)("div",{className:"flex-1 space-y-2",children:[(0,t.jsx)(f.E,{className:"h-4 w-24"}),(0,t.jsx)(f.E,{className:"h-3 w-20"})]})]}),(0,t.jsxs)("div",{className:"space-y-2 mb-3",children:[(0,t.jsxs)("div",{className:"flex gap-1",children:[(0,t.jsx)(f.E,{className:"h-5 w-16 rounded-full"}),(0,t.jsx)(f.E,{className:"h-5 w-20 rounded-full"}),(0,t.jsx)(f.E,{className:"h-5 w-14 rounded-full"})]}),(0,t.jsx)(f.E,{className:"h-3 w-full"})]}),(0,t.jsx)(f.E,{className:"h-8 w-full"})]})},s))}):R.length>0?(0,t.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:R.map((e,s)=>(0,t.jsx)(l.Zp,{className:"hover:shadow-lg transition-shadow",children:(0,t.jsxs)(l.Wu,{className:"p-4",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-3 mb-3",children:[(0,t.jsxs)(m.eu,{children:[(0,t.jsx)(m.BK,{src:e.profile.avatar}),(0,t.jsx)(m.q5,{children:e.profile.username[0]})]}),(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsx)("h3",{className:"font-semibold",children:e.profile.username}),(0,t.jsxs)("div",{className:"flex items-center text-sm text-muted-foreground",children:[(0,t.jsx)(O.A,{className:"w-3 h-3 mr-1 fill-yellow-400 text-yellow-400"}),e.compatibility,"% compatible"]})]})]}),(0,t.jsxs)("div",{className:"space-y-2 mb-3",children:[(0,t.jsx)("div",{className:"flex flex-wrap gap-1",children:e.commonGames.slice(0,3).map(e=>(0,t.jsx)(d.E,{variant:"secondary",className:"text-xs",children:e},e))}),(0,t.jsx)("div",{className:"text-xs text-muted-foreground",children:e.reasons.slice(0,2).join(", ")})]}),(0,t.jsxs)(r.$,{size:"sm",className:"w-full",onClick:()=>ed(e),children:[(0,t.jsx)(L.A,{className:"w-4 h-4 mr-2"}),"Enviar Solicitud"]})]})},s))}):null]}),(0,t.jsx)(u.av,{value:"profile",className:"space-y-6",children:(0,t.jsxs)(l.Zp,{children:[(0,t.jsx)(l.aR,{children:(0,t.jsxs)(l.ZB,{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsx)(z.A,{className:"w-5 h-5 mr-2"}),"Mi Perfil de Matching"]}),(0,t.jsx)(r.$,{variant:"outline",onClick:()=>b(!y),children:y?"Cancelar":"Editar"})]})}),(0,t.jsx)(l.Wu,{className:"space-y-6",children:y?(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)(n.J,{className:"text-base font-semibold",children:"Juegos que juegas"}),(0,t.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2 mt-2",children:H.map(e=>(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)(o.S,{checked:N.games.includes(e),onCheckedChange:s=>{s?ey(e):eb(e)}}),(0,t.jsx)(n.J,{className:"text-sm",children:e})]},e))})]}),N.games.length>0&&(0,t.jsxs)("div",{children:[(0,t.jsx)(n.J,{className:"text-base font-semibold",children:"Niveles de Habilidad"}),(0,t.jsx)("div",{className:"space-y-3 mt-2",children:N.games.map(e=>(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)("span",{className:"text-sm",children:e}),(0,t.jsxs)(c.l6,{value:N.skillLevels[e]||"",onValueChange:s=>eN(e,s),children:[(0,t.jsx)(c.bq,{className:"w-32",children:(0,t.jsx)(c.yv,{placeholder:"Nivel"})}),(0,t.jsx)(c.gC,{children:W.map(e=>(0,t.jsx)(c.eb,{value:e.value,children:e.label},e.value))})]})]},e))})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(n.J,{className:"text-base font-semibold",children:"Disponibilidad"}),(0,t.jsxs)("div",{className:"space-y-3 mt-2",children:[(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)(o.S,{checked:N.availability.weekdays,onCheckedChange:e=>A(s=>({...s,availability:{...s.availability,weekdays:!!e}}))}),(0,t.jsx)(n.J,{children:"D\xedas de semana"})]}),(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)(o.S,{checked:N.availability.weekends,onCheckedChange:e=>A(s=>({...s,availability:{...s.availability,weekends:!!e}}))}),(0,t.jsx)(n.J,{children:"Fines de semana"})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(n.J,{className:"text-sm",children:"Horarios preferidos"}),(0,t.jsx)("div",{className:"grid grid-cols-2 gap-2 mt-1",children:X.map(e=>(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)(o.S,{checked:N.availability.preferredTimes.includes(e.value),onCheckedChange:s=>{A(a=>({...a,availability:{...a.availability,preferredTimes:s?[...a.availability.preferredTimes,e.value]:a.availability.preferredTimes.filter(s=>s!==e.value)}}))}}),(0,t.jsx)(n.J,{className:"text-xs",children:e.label})]},e.value))})]})]})]}),(0,t.jsxs)("div",{className:"flex space-x-4",children:[(0,t.jsx)(r.$,{onClick:ef,className:"flex-1",children:"Guardar Perfil"}),(0,t.jsx)(r.$,{variant:"outline",onClick:()=>b(!1),className:"flex-1",children:"Cancelar"})]})]}):(0,t.jsxs)("div",{className:"text-center py-8",children:[(0,t.jsx)(V.A,{className:"w-12 h-12 mx-auto text-muted-foreground mb-4"}),(0,t.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"Configura tu perfil"}),(0,t.jsx)("p",{className:"text-muted-foreground mb-4",children:"Crea tu perfil de matching para encontrar compa\xf1eros de equipo"}),(0,t.jsx)(r.$,{onClick:()=>b(!0),children:"Crear Perfil"})]})})]})}),(0,t.jsx)(u.av,{value:"requests",className:"space-y-6",children:(0,t.jsxs)(l.Zp,{children:[(0,t.jsx)(l.aR,{children:(0,t.jsxs)(l.ZB,{className:"flex items-center",children:[(0,t.jsx)(F.A,{className:"w-5 h-5 mr-2"}),"Solicitudes de Match"]})}),(0,t.jsx)(l.Wu,{children:0===en.length?(0,t.jsxs)("div",{className:"text-center py-8",children:[(0,t.jsx)(L.A,{className:"w-12 h-12 mx-auto text-muted-foreground mb-4"}),(0,t.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"No hay solicitudes"}),(0,t.jsx)("p",{className:"text-muted-foreground",children:"Cuando recibas solicitudes de match aparecer\xe1n aqu\xed"})]}):(0,t.jsx)("div",{className:"space-y-4",children:en.map(e=>(0,t.jsx)(l.Zp,{children:(0,t.jsx)(l.Wu,{className:"p-4",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,t.jsx)(m.eu,{children:(0,t.jsx)(m.q5,{children:"U"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h4",{className:"font-semibold",children:"Solicitud de Match"}),(0,t.jsxs)("p",{className:"text-sm text-muted-foreground",children:["Juego: ",e.game]}),e.message&&(0,t.jsxs)("p",{className:"text-sm mt-1",children:['"',e.message,'"']})]})]}),(0,t.jsxs)("div",{className:"flex space-x-2",children:[(0,t.jsxs)(r.$,{size:"sm",onClick:()=>ej(e.id,"accepted"),children:[(0,t.jsx)(B.A,{className:"w-4 h-4 mr-1"}),"Aceptar"]}),(0,t.jsxs)(r.$,{size:"sm",variant:"outline",onClick:()=>ej(e.id,"declined"),children:[(0,t.jsx)(Z.A,{className:"w-4 h-4 mr-1"}),"Rechazar"]})]})]})})},e.id))})})]})}),(0,t.jsxs)(u.av,{value:"stats",className:"space-y-6",children:[(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,t.jsx)(l.Zp,{children:(0,t.jsx)(l.Wu,{className:"p-6",children:(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsx)(T.A,{className:"w-8 h-8 text-blue-500"}),(0,t.jsxs)("div",{className:"ml-4",children:[(0,t.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Total Matches"}),(0,t.jsx)("p",{className:"text-2xl font-bold",children:eh.totalMatches})]})]})})}),(0,t.jsx)(l.Zp,{children:(0,t.jsx)(l.Wu,{className:"p-6",children:(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsx)(B.A,{className:"w-8 h-8 text-green-500"}),(0,t.jsxs)("div",{className:"ml-4",children:[(0,t.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Aceptadas"}),(0,t.jsx)("p",{className:"text-2xl font-bold",children:eh.acceptedRequests})]})]})})}),(0,t.jsx)(l.Zp,{children:(0,t.jsx)(l.Wu,{className:"p-6",children:(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsx)(L.A,{className:"w-8 h-8 text-purple-500"}),(0,t.jsxs)("div",{className:"ml-4",children:[(0,t.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Enviadas"}),(0,t.jsx)("p",{className:"text-2xl font-bold",children:eh.sentRequests})]})]})})}),(0,t.jsx)(l.Zp,{children:(0,t.jsx)(l.Wu,{className:"p-6",children:(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsx)(_.A,{className:"w-8 h-8 text-yellow-500"}),(0,t.jsxs)("div",{className:"ml-4",children:[(0,t.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Tasa de \xc9xito"}),(0,t.jsxs)("p",{className:"text-2xl font-bold",children:[eh.totalMatches>0?Math.round(eh.acceptedRequests/eh.totalMatches*100):0,"%"]})]})]})})})]}),(null==eh?void 0:eh.successRate)!==void 0&&(0,t.jsxs)(l.Zp,{children:[(0,t.jsx)(l.aR,{children:(0,t.jsxs)(l.ZB,{className:"flex items-center gap-2",children:[(0,t.jsx)(_.A,{className:"h-5 w-5"}),"Estad\xedsticas Avanzadas"]})}),(0,t.jsxs)(l.Wu,{children:[(0,t.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4 mb-6",children:[(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsxs)("div",{className:"text-xl font-bold text-cyan-600",children:[Math.round(eh.averageCompatibility),"%"]}),(0,t.jsx)("div",{className:"text-sm text-muted-foreground",children:"Compatibilidad promedio"})]}),(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"text-xl font-bold text-indigo-600",children:eh.profileViews}),(0,t.jsx)("div",{className:"text-sm text-muted-foreground",children:"Vistas de perfil"})]}),(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsxs)("div",{className:"text-xl font-bold text-pink-600",children:[Math.round(eh.successRate),"%"]}),(0,t.jsx)("div",{className:"text-sm text-muted-foreground",children:"Tasa de \xe9xito"})]})]}),(0,t.jsxs)("div",{className:"mb-4",children:[(0,t.jsx)("h5",{className:"font-medium mb-2 text-sm",children:"Compatibilidad Promedio"}),(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)("div",{className:"flex-1 bg-gray-200 rounded-full h-2",children:(0,t.jsx)("div",{className:"bg-blue-500 h-2 rounded-full",style:{width:"".concat(eh.averageCompatibility,"%")}})}),(0,t.jsxs)("span",{className:"text-sm font-medium",children:[Math.round(eh.averageCompatibility),"%"]})]})]}),eh.topGames&&eh.topGames.length>0&&(0,t.jsxs)("div",{children:[(0,t.jsx)("h5",{className:"font-medium mb-2 text-sm",children:"Juegos M\xe1s Populares"}),(0,t.jsx)("div",{className:"flex flex-wrap gap-1",children:eh.topGames.slice(0,5).map(e=>(0,t.jsxs)(d.E,{variant:"outline",className:"text-xs",children:[e.game," (",e.matches,")"]},e.game))})]})]})]})]})]}),(0,t.jsx)(h.lG,{open:!!eo,onOpenChange:()=>ed(null),children:(0,t.jsxs)(h.Cf,{children:[(0,t.jsx)(h.c7,{children:(0,t.jsx)(h.L3,{children:"Enviar Solicitud de Match"})}),eo&&(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,t.jsxs)(m.eu,{children:[(0,t.jsx)(m.BK,{src:eo.profile.avatar}),(0,t.jsx)(m.q5,{children:eo.profile.username[0]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"font-semibold",children:eo.profile.username}),(0,t.jsxs)("p",{className:"text-sm text-muted-foreground",children:[eo.compatibility,"% compatible"]})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(n.J,{children:"Juego"}),(0,t.jsxs)(c.l6,{defaultValue:eo.commonGames[0],children:[(0,t.jsx)(c.bq,{children:(0,t.jsx)(c.yv,{})}),(0,t.jsx)(c.gC,{children:eo.commonGames.map(e=>(0,t.jsx)(c.eb,{value:e,children:e},e))})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(n.J,{children:"Mensaje (opcional)"}),(0,t.jsx)(x.T,{placeholder:"\xa1Hola! Me gustar\xeda jugar contigo...",value:em,onChange:e=>eu(e.target.value),maxLength:500})]}),(0,t.jsxs)("div",{className:"flex space-x-2",children:[(0,t.jsx)(r.$,{onClick:()=>ev(eo.profile.userId,eo.commonGames[0]),className:"flex-1",children:"Enviar Solicitud"}),(0,t.jsx)(r.$,{variant:"outline",onClick:()=>ed(null),className:"flex-1",children:"Cancelar"})]})]})]})})]})}},85057:(e,s,a)=>{"use strict";a.d(s,{J:()=>o});var t=a(95155),i=a(12115),r=a(40968),l=a(74466),n=a(59434);let c=(0,l.F)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),o=i.forwardRef((e,s)=>{let{className:a,...i}=e;return(0,t.jsx)(r.b,{ref:s,className:(0,n.cn)(c(),a),...i})});o.displayName=r.b.displayName},87481:(e,s,a)=>{"use strict";a.d(s,{dj:()=>u,oR:()=>m});var t=a(12115);let i=0,r=new Map,l=e=>{if(r.has(e))return;let s=setTimeout(()=>{r.delete(e),d({type:"REMOVE_TOAST",toastId:e})},1e6);r.set(e,s)},n=(e,s)=>{switch(s.type){case"ADD_TOAST":return{...e,toasts:[s.toast,...e.toasts].slice(0,1)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===s.toast.id?{...e,...s.toast}:e)};case"DISMISS_TOAST":{let{toastId:a}=s;return a?l(a):e.toasts.forEach(e=>{l(e.id)}),{...e,toasts:e.toasts.map(e=>e.id===a||void 0===a?{...e,open:!1}:e)}}case"REMOVE_TOAST":if(void 0===s.toastId)return{...e,toasts:[]};return{...e,toasts:e.toasts.filter(e=>e.id!==s.toastId)}}},c=[],o={toasts:[]};function d(e){o=n(o,e),c.forEach(e=>{e(o)})}function m(e){let{...s}=e,a=(i=(i+1)%Number.MAX_SAFE_INTEGER).toString(),t=()=>d({type:"DISMISS_TOAST",toastId:a});return d({type:"ADD_TOAST",toast:{...s,id:a,open:!0,onOpenChange:e=>{e||t()}}}),{id:a,dismiss:t,update:e=>d({type:"UPDATE_TOAST",toast:{...e,id:a}})}}function u(){let[e,s]=t.useState(o);return t.useEffect(()=>(c.push(s),()=>{let e=c.indexOf(s);e>-1&&c.splice(e,1)}),[]),{...e,toast:m,dismiss:e=>d({type:"DISMISS_TOAST",toastId:e})}}},88539:(e,s,a)=>{"use strict";a.d(s,{T:()=>l});var t=a(95155),i=a(12115),r=a(59434);let l=i.forwardRef((e,s)=>{let{className:a,...i}=e;return(0,t.jsx)("textarea",{className:(0,r.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",a),ref:s,...i})});l.displayName="Textarea"},91394:(e,s,a)=>{"use strict";a.d(s,{BK:()=>c,eu:()=>n,q5:()=>o});var t=a(95155),i=a(12115),r=a(85977),l=a(59434);let n=i.forwardRef((e,s)=>{let{className:a,...i}=e;return(0,t.jsx)(r.bL,{ref:s,className:(0,l.cn)("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",a),...i})});n.displayName=r.bL.displayName;let c=i.forwardRef((e,s)=>{let{className:a,...i}=e;return(0,t.jsx)(r._V,{ref:s,className:(0,l.cn)("aspect-square h-full w-full",a),...i})});c.displayName=r._V.displayName;let o=i.forwardRef((e,s)=>{let{className:a,...i}=e;return(0,t.jsx)(r.H4,{ref:s,className:(0,l.cn)("flex h-full w-full items-center justify-center rounded-full bg-muted",a),...i})});o.displayName=r.H4.displayName}},e=>{var s=s=>e(e.s=s);e.O(0,[9135,7210,5769,9863,3856,9550,5679,8722,4434,8049,9892,8441,1684,7358],()=>s(63055)),_N_E=e.O()}]);